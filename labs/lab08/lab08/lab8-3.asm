%include 'in_out.asm'

SECTION .data
    msg db "Результат: ",0

SECTION .text
    global _start

_start:
    pop ecx         ; Извлекаем из стека в `ecx` количество аргументов
    pop edx         ; Извлекаем из стека в `edx` имя программы
    sub ecx, 1      ; Уменьшаем `ecx` на 1 (количество аргументов без названия программы)
    
    mov esi, 1      ; Используем `esi` для хранения произведения (начальное значение 1!)
    
    ; Проверяем, есть ли аргументы
    cmp ecx, 0
    jz _no_args     ; Если аргументов нет - переходим к выводу
    
next:
    pop eax         ; Извлекаем следующий аргумент из стека
    call atoi       ; Преобразуем символ в число
    
    ; Умножаем: esi = esi * eax
    imul esi, eax   ; Умножение со знаком
    
    loop next       ; Переход к обработке следующего аргумента
    jmp _end

_no_args:
    mov esi, 0      ; Если аргументов нет, произведение = 0

_end:
    mov eax, msg    ; Вывод сообщения "Результат: "
    call sprint
    mov eax, esi    ; Записываем произведение в регистр `eax`
    call iprintLF   ; Печать результата
    call quit       ; Завершение программы
